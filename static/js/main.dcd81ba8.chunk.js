(this.webpackJsonpcompanion=this.webpackJsonpcompanion||[]).push([[0],{18:function(e,t,n){},52:function(e,t,n){},54:function(e,t,n){},64:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){"use strict";n.r(t);var a,r,s=n(0),o=n.n(s),c=n(21),i=n.n(c),l=(n(52),n(9)),d=n(16),u=n(8),j=(n(18),n(7)),p=n.n(j),m=n(12),b=(n(54),n(10)),h=n(11),f=n(28),x=n.n(f),O=n(1);function v(){return(v=Object(m.a)(p.a.mark((function e(t,n){var s,o,c,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("start recording"),e.next=3,fetch("".concat("https://companion-htv5.herokuapp.com/api/v1","/assemblyai"));case 3:return s=e.sent,e.next=6,s.json();case 6:return(o=e.sent).error&&alert(o.error),c=o.token,e.next=11,new WebSocket("wss://api.assemblyai.com/v2/realtime/ws?sample_rate=16000&token=".concat(c));case 11:a=e.sent,i={},a.onmessage=function(e){var a=t,r=JSON.parse(e.data);console.dir(r),i[r.audio_start]=r.text,console.dir(i);var s=Object.keys(i);s.sort((function(e,t){return e-t}));for(var o=0,c=s;o<c.length;o++){var l=c[o];i[l]&&(a+=" ".concat(i[l]))}n(a)},a.onerror=function(e){console.error(e),a.close()},a.onclose=function(e){console.log(e),a=null},a.onopen=function(){navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){(r=new x.a(e,{type:"audio",mimeType:"audio/webm;codecs=pcm",recorderType:f.StereoAudioRecorder,timeSlice:250,desiredSampRate:16e3,numberOfAudioChannels:1,bufferSize:4096,audioBitsPerSecond:128e3,ondataavailable:function(e){var t=new FileReader;t.onload=function(){var e=t.result;a&&a.send(JSON.stringify({audio_data:e.split("base64,")[1]}))},t.readAsDataURL(e)}})).startRecording()})).catch((function(e){return console.error(e)}))};case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return(g=Object(m.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("stop recording"),a&&(a.send(JSON.stringify({terminate_session:!0})),a.close(),a=null),r&&(r.pauseRecording(),r=null);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){var t=Object(s.useState)(!1),n=Object(l.a)(t,2),a=n[0],r=n[1];return Object(O.jsx)(h.a,{size:"sm",className:"record-button",variant:"outline-danger",onClick:function(){a?function(){g.apply(this,arguments)}():function(e,t){v.apply(this,arguments)}(e.text,e.setText),r(!a)},children:a?"Stop":"Record"})}function w(e){var t,n;return Object(O.jsx)(b.a.Group,{className:"mb-2",controlId:null!==(t=e.controlId)&&void 0!==t?t:"formUsername",children:Object(O.jsx)(b.a.Control,{type:"email",placeholder:null!==(n=e.label)&&void 0!==n?n:"Email address"})})}function N(e){var t,n;return Object(O.jsx)(b.a.Group,{className:"mb-2",controlId:null!==(t=e.controlId)&&void 0!==t?t:"formPassword",children:Object(O.jsx)(b.a.Control,{type:"password",placeholder:null!==(n=e.label)&&void 0!==n?n:"Password"})})}function k(e){return Object(O.jsx)(b.a.Group,{className:"mb-2",controlId:e.controlId,children:Object(O.jsx)(b.a.Control,{type:"text",placeholder:e.label,value:e.value})})}function M(e){return Object(O.jsxs)(b.a.Group,{className:"mb-2 flex-row",controlId:e.controlId,children:[Object(O.jsx)(b.a.Control,{type:"text",placeholder:e.label,value:e.value,onChange:function(t){return e.setValue(t.target.value)},onKeyPress:e.onKeyPress}),Object(O.jsx)(y,{text:e.value,setText:e.setValue})]})}var S=function(e){var t=Object(u.f)(),n=Object(s.useState)(!1),a=Object(l.a)(n,2),r=a[0],o=a[1];function c(){return(c=Object(m.a)(p.a.mark((function n(a){var s,c,i,l,d,u,j,m;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a.preventDefault(),!r){n.next=3;break}return n.abrupt("return");case 3:return o(!0),s=a.target,c=s.elements.formFirstName.value,i=s.elements.formLastName.value,l=s.elements.formUsername.value,d=s.elements.formPassword.value,u={firstName:c,lastName:i,email:l,password:d,logs:[]},n.prev=10,n.next=13,fetch("".concat("https://companion-htv5.herokuapp.com/api/v1","/users"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(u)});case 13:return j=n.sent,n.next=16,j.json();case 16:m=n.sent,console.dir(m),m.error?window.alert("Couldn't create the account"):(e.setUser(m.user),t.push("/assess")),n.next=25;break;case 21:n.prev=21,n.t0=n.catch(10),console.log(n.t0),window.alert("Failed to contact server :(");case 25:o(!1);case 26:case"end":return n.stop()}}),n,null,[[10,21]])})))).apply(this,arguments)}return Object(O.jsxs)("div",{className:"reg-container align-center",children:[Object(O.jsx)("h1",{children:"Register"}),Object(O.jsxs)(b.a,{className:"reg width-30",onSubmit:function(e){return c.apply(this,arguments)},children:[Object(O.jsx)(k,{controlId:"formFirstName",label:"First name"}),Object(O.jsx)(k,{controlId:"formLastName",label:"Last name"}),Object(O.jsx)(w,{}),Object(O.jsx)(N,{}),Object(O.jsx)(N,{controlId:"formConfirmPassword",label:"Re-enter password"}),Object(O.jsx)(h.a,{className:"fullwidth",variant:"primary",disabled:r,type:"submit",children:r?"Registering\u2026":"Register"}),Object(O.jsx)("div",{className:"login-link-container",children:Object(O.jsx)(h.a,{className:"fullwidth",variant:"primary",onClick:function(){return t.push("/login")},children:"Log into existing account"})})]})]})};function C(e){var t=Object(u.f)(),n=Object(s.useState)(!1),a=Object(l.a)(n,2),r=a[0],o=a[1];function c(){return(c=Object(m.a)(p.a.mark((function n(a){var s,c,i,l,d,u;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a.preventDefault(),!r){n.next=3;break}return n.abrupt("return");case 3:return o(!0),s=a.target,c=s.elements.formUsername.value,i=s.elements.formPassword.value,l={email:c,password:i},console.dir(l),n.prev=9,console.log("".concat("https://companion-htv5.herokuapp.com/api/v1","/validate")),n.next=13,fetch("".concat("https://companion-htv5.herokuapp.com/api/v1","/validate"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(l)});case 13:return d=n.sent,n.next=16,d.json();case 16:u=n.sent,console.dir(u),u.data?(e.setUser(u.data),t.push("/assess")):window.alert("Invalid email or password, please try again"),n.next=25;break;case 21:n.prev=21,n.t0=n.catch(9),console.log(n.t0),window.alert("Failed to contact server :(");case 25:o(!1);case 26:case"end":return n.stop()}}),n,null,[[9,21]])})))).apply(this,arguments)}return Object(O.jsxs)("div",{className:"align-center",children:[Object(O.jsx)("h1",{children:"Log in"}),Object(O.jsxs)(b.a,{className:"width-30",onSubmit:function(e){return c.apply(this,arguments)},children:[Object(O.jsx)(w,{}),Object(O.jsx)(N,{}),Object(O.jsx)(h.a,{className:"fullwidth",variant:"primary",disabled:r,type:"submit",children:r?"Logging in\u2026":"Log in"})]})]})}n(64);var I=n(47);function T(){var e=Object(u.f)();return Object(O.jsx)(I.a,{steps:[{style:{transform:"translate(0,-500px)"},duration:0},{style:{transform:"translate(0,0)"},duration:800}],children:Object(O.jsxs)("div",{className:"align-center",children:[Object(O.jsx)("h1",{children:"Companion"}),Object(O.jsx)("h2",{children:"your mindfulness buddy"}),Object(O.jsx)(h.a,{className:"wide get-started",size:"lg",variant:"primary",onClick:function(){return e.push("/register")},children:"Get Started"})]})})}n(73);function P(e){var t=Object(u.f)(),n=Object(s.useState)(!1),a=Object(l.a)(n,2),r=a[0],o=a[1],c=Object(s.useState)(!1),i=Object(l.a)(c,2),d=i[0],j=i[1],f=Object(s.useState)(null),x=Object(l.a)(f,2),v=x[0],g=x[1],y=Object(s.useState)(""),w=Object(l.a)(y,2),N=w[0],k=w[1];function S(e){return C.apply(this,arguments)}function C(){return(C=Object(m.a)(p.a.mark((function t(n){var a,s,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),!r){t.next=3;break}return t.abrupt("return");case 3:return o(!0),a={mood:v,message:N},t.prev=5,t.next=8,fetch("".concat("https://companion-htv5.herokuapp.com/api/v1","/").concat(e.user._id,"/logs"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});case 8:return s=t.sent,t.next=11,s.json();case 11:c=t.sent,console.dir(c),c.error?(console.dir(c.error),window.alert("Couldn't save, please try again")):j(!0),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(5),console.dir(t.t0),window.alert("Failed to contact server :(");case 20:o(!1);case 21:case"end":return t.stop()}}),t,null,[[5,16]])})))).apply(this,arguments)}return Object(O.jsxs)("div",{className:"align-center flex-column gap-4",children:[Object(O.jsxs)("h1",{children:["Welcome back, ",e.user.firstName]}),Object(O.jsx)("h2",{children:"How are you feeling today?"}),Object(O.jsx)(R,{mood:v,setMood:g}),Object(O.jsxs)(b.a,{className:"width-50",onSubmit:S,children:[Object(O.jsx)(M,{controlId:"formMessage",label:"Describe your day\u2026",value:N,setValue:k}),Object(O.jsxs)("div",{className:"align-center flex-column",children:[Object(O.jsx)(h.a,{className:"fullwidth",variant:"success",onClick:S,disabled:!v||r||d,children:r?"Saving\u2026":d?"Entry saved":"Save"}),Object(O.jsxs)("div",{className:"fullwidth flex-row gap-2",children:[Object(O.jsx)(h.a,{className:"fullwidth",variant:"primary",onClick:function(){t.push("/diary")},children:"My diary"}),Object(O.jsx)(h.a,{className:"fullwidth",variant:"primary",onClick:function(){t.push("/companion")},children:"Talk to someone"})]})]})]})]})}function R(e){return Object(O.jsxs)("div",{className:"mood-chooser",children:[Object(O.jsx)(U,{currentMood:e.mood,setMood:e.setMood,mood:"\u263a\ufe0f"}),Object(O.jsx)(U,{currentMood:e.mood,setMood:e.setMood,mood:"\ud83d\ude04"}),Object(O.jsx)(U,{currentMood:e.mood,setMood:e.setMood,mood:"\ud83d\ude00"}),Object(O.jsx)(U,{currentMood:e.mood,setMood:e.setMood,mood:"\ud83d\ude42"}),Object(O.jsx)(U,{currentMood:e.mood,setMood:e.setMood,mood:"\ud83d\ude10"}),Object(O.jsx)("hr",{}),Object(O.jsx)(U,{currentMood:e.mood,setMood:e.setMood,mood:"\ud83d\ude15"}),Object(O.jsx)(U,{currentMood:e.mood,setMood:e.setMood,mood:"\u2639\ufe0f"}),Object(O.jsx)(U,{currentMood:e.mood,setMood:e.setMood,mood:"\ud83d\ude14"}),Object(O.jsx)(U,{currentMood:e.mood,setMood:e.setMood,mood:"\ud83d\ude25"}),Object(O.jsx)(U,{currentMood:e.mood,setMood:e.setMood,mood:"\ud83d\ude2d"})]})}function U(e){return Object(O.jsx)(h.a,{size:"sm",variant:"primary",className:"mood-button ",active:e.currentMood==e.mood,onClick:function(){return e.setMood(e.mood)},children:e.mood})}n(74),n(75);var A=function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),n=t[0],a=t[1],r=Object(s.useState)(""),o=Object(l.a)(r,2),c=o[0],i=o[1],d=Object(s.useState)(""),u=Object(l.a)(d,2),j=(u[0],u[1]),b=function(){var e=Object(m.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://companion-api-htv5.herokuapp.com/api/v1/12345678",e.next=3,fetch("https://companion-api-htv5.herokuapp.com/api/v1/12345678",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({message:t})});case 3:return n=e.sent,e.next=6,n.json();case 6:return a=e.sent,j(a),e.abrupt("return",a.message);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(m.a)(p.a.mark((function e(){var t,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.push({user:c}),a(n),t=c,i(""),e.next=6,b(t);case 6:""===(r=e.sent)&&(r="Can you rephrase that? I don't seem to understand"),n.push({bot:r}),a(n),j("");case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(O.jsxs)("div",{children:[Object(O.jsx)("h1",{children:"Companion"}),Object(O.jsx)("div",{className:"messages-view-container",children:Object(O.jsx)("div",{className:"messages-view",children:Object(O.jsx)("div",{className:"message",children:n.map((function(e){return Object(O.jsx)("div",{children:e.user?Object(O.jsxs)("div",{className:"user-message",children:["You: ",e.user]}):Object(O.jsxs)("div",{className:"bot-message",children:["Bot: ",e.bot]})})}))})})}),Object(O.jsx)(M,{className:"message-input",controlId:"formMessage",label:"Type Message Here",value:c,setValue:i,onKeyPress:function(e){return"Enter"===e.key&&h()}})]})};n(93);function F(e){Object(u.f)();var t=Object(s.useState)(!1),n=Object(l.a)(t,2),a=(n[0],n[1]),r=Object(s.useState)(null),o=Object(l.a)(r,2),c=o[0],i=o[1];return Object(s.useEffect)(Object(m.a)(p.a.mark((function t(){var n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a(!0),t.prev=1,t.next=4,fetch("".concat("https://companion-htv5.herokuapp.com/api/v1","/").concat(e.user._id,"/logs"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 4:return n=t.sent,t.next=7,n.json();case 7:r=t.sent,console.dir(r),r.error?(console.dir(r.error),window.alert("Couldn't retrieve entries, please try again")):i(r.logs),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),console.dir(t.t0),window.alert("Failed to contact server :(");case 16:a(!1);case 17:case"end":return t.stop()}}),t,null,[[1,12]])}))),[e.user]),Object(O.jsxs)("div",{className:"width-60 flex-column gap-4",children:[Object(O.jsx)("h1",{children:"My diary"}),Object(O.jsx)("ul",{className:"fullwidth diary-container",children:c&&c.map((function(e,t){return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("li",{children:Object(O.jsx)(J,{log:e})},"log-entry-".concat(t)),t!==c.length-1&&Object(O.jsx)("hr",{})]})}))})]})}function J(e){return Object(O.jsxs)("div",{className:"flex-row",style:{justifyContent:"flex-start"},children:[Object(O.jsx)("p",{className:"align-left mood",children:e.log.mood}),Object(O.jsx)("p",{className:"align-left message",children:e.log.message})]})}var L=function(){var e=Object(s.useState)({_id:"616b918b2749f77e074616ac",email:"demo@demo.user",firstName:"Demo",lastName:"User",password:"password",logs:[]}),t=Object(l.a)(e,2),n=t[0],a=t[1];return Object(O.jsx)("div",{className:"App flex-column",children:Object(O.jsx)(d.a,{children:Object(O.jsxs)(u.c,{children:[Object(O.jsx)(u.a,{exact:!0,path:"/",children:Object(O.jsx)(T,{})}),Object(O.jsx)(u.a,{exact:!0,path:"/login",children:Object(O.jsx)(C,{setUser:a})}),Object(O.jsx)(u.a,{exact:!0,path:"/register",children:Object(O.jsx)(S,{setUser:a})}),Object(O.jsx)(u.a,{exact:!0,path:"/assess",children:Object(O.jsx)(P,{user:n})}),Object(O.jsx)(u.a,{exact:!0,path:"/companion",children:Object(O.jsx)(A,{})}),Object(O.jsx)(u.a,{exact:!0,path:"/diary",children:Object(O.jsx)(F,{user:n})})]})})})};i.a.render(Object(O.jsx)(o.a.StrictMode,{children:Object(O.jsx)(L,{})}),document.getElementById("root"))}},[[94,1,2]]]);
//# sourceMappingURL=main.dcd81ba8.chunk.js.map