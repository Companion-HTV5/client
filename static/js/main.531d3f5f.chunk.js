(this.webpackJsonpcompanion=this.webpackJsonpcompanion||[]).push([[0],{17:function(e,t,a){},41:function(e,t,a){},43:function(e,t,a){},53:function(e,t,a){},62:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){"use strict";a.r(t);var n,r,o=a(0),s=a.n(o),c=a(18),i=a.n(c),l=(a(41),a(9)),d=a(15),u=a(8),j=(a(17),a(10)),m=a.n(j),p=a(14),b=(a(43),a(7)),h=a(11),x=a(24),O=a.n(x),f=a(1);function v(){return(v=Object(p.a)(m.a.mark((function e(t,a){var o,s,c,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("start recording"),e.next=3,fetch("".concat("https://companion-htv5.herokuapp.com/api/v1","/assemblyai"));case 3:return o=e.sent,e.next=6,o.json();case 6:return(s=e.sent).error&&alert(s.error),c=s.token,e.next=11,new WebSocket("wss://api.assemblyai.com/v2/realtime/ws?sample_rate=16000&token=".concat(c));case 11:n=e.sent,i={},n.onmessage=function(e){var n=t,r=JSON.parse(e.data);console.dir(r),i[r.audio_start]=r.text,console.dir(i);var o=Object.keys(i);o.sort((function(e,t){return e-t}));for(var s=0,c=o;s<c.length;s++){var l=c[s];i[l]&&(n+=" ".concat(i[l]))}a(n)},n.onerror=function(e){console.error(e),n.close()},n.onclose=function(e){console.log(e),n=null},n.onopen=function(){navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){(r=new O.a(e,{type:"audio",mimeType:"audio/webm;codecs=pcm",recorderType:x.StereoAudioRecorder,timeSlice:250,desiredSampRate:16e3,numberOfAudioChannels:1,bufferSize:4096,audioBitsPerSecond:128e3,ondataavailable:function(e){var t=new FileReader;t.onload=function(){var e=t.result;n&&n.send(JSON.stringify({audio_data:e.split("base64,")[1]}))},t.readAsDataURL(e)}})).startRecording()})).catch((function(e){return console.error(e)}))};case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return(g=Object(p.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("stop recording"),n&&(n.send(JSON.stringify({terminate_session:!0})),n.close(),n=null),r&&(r.pauseRecording(),r=null);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){var t=Object(o.useState)(!1),a=Object(l.a)(t,2),n=a[0],r=a[1];return Object(f.jsx)(h.a,{size:"sm",className:"record-button",variant:"outline-danger",onClick:function(){n?function(){g.apply(this,arguments)}():function(e,t){v.apply(this,arguments)}(e.text,e.setText),r(!n)},children:n?"Stop":"Record"})}function y(e){var t,a;return Object(f.jsx)(b.a.Group,{className:"mb-2",controlId:null!==(t=e.controlId)&&void 0!==t?t:"formUsername",children:Object(f.jsx)(b.a.Control,{type:"email",placeholder:null!==(a=e.label)&&void 0!==a?a:"Email address"})})}function N(e){var t,a;return Object(f.jsx)(b.a.Group,{className:"mb-2",controlId:null!==(t=e.controlId)&&void 0!==t?t:"formPassword",children:Object(f.jsx)(b.a.Control,{type:"password",placeholder:null!==(a=e.label)&&void 0!==a?a:"Password"})})}function M(e){return Object(f.jsx)(b.a.Group,{className:"mb-2",controlId:e.controlId,children:Object(f.jsx)(b.a.Control,{type:"text",placeholder:e.label,value:e.value})})}function k(e){return Object(f.jsxs)(b.a.Group,{className:"mb-2 flex-row",controlId:e.controlId,children:[Object(f.jsx)(b.a.Control,{type:"text",placeholder:e.label,value:e.value,onChange:function(t){return e.setValue(t.target.value)}}),Object(f.jsx)(w,{text:e.value,setText:e.setValue})]})}var S=function(e){var t=Object(u.f)(),a=Object(o.useState)(!1),n=Object(l.a)(a,2),r=n[0],s=n[1];function c(){return(c=Object(p.a)(m.a.mark((function a(n){var o,c,i,l,d,u,j,p;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n.preventDefault(),!r){a.next=3;break}return a.abrupt("return");case 3:return s(!0),o=n.target,c=o.elements.formFirstName.value,i=o.elements.formLastName.value,l=o.elements.formUsername.value,d=o.elements.formPassword.value,u={firstName:c,lastName:i,email:l,password:d,logs:[]},a.prev=10,a.next=13,fetch("".concat("https://companion-htv5.herokuapp.com/api/v1","/users"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(u)});case 13:return j=a.sent,a.next=16,j.json();case 16:p=a.sent,console.dir(p),p.error?window.alert("Couldn't create the account"):(e.setUser(u),t.push("/assess")),a.next=25;break;case 21:a.prev=21,a.t0=a.catch(10),console.log(a.t0),window.alert("Failed to contact server :(");case 25:s(!1);case 26:case"end":return a.stop()}}),a,null,[[10,21]])})))).apply(this,arguments)}return Object(f.jsxs)("div",{className:"reg-container align-center",children:[Object(f.jsx)("h1",{children:"Register"}),Object(f.jsxs)(b.a,{className:"reg width-30",onSubmit:function(e){return c.apply(this,arguments)},children:[Object(f.jsx)(M,{controlId:"formFirstName",label:"First name"}),Object(f.jsx)(M,{controlId:"formLastName",label:"Last name"}),Object(f.jsx)(y,{}),Object(f.jsx)(N,{}),Object(f.jsx)(N,{controlId:"formConfirmPassword",label:"Re-enter password"}),Object(f.jsx)(h.a,{className:"fullwidth",variant:"primary",disabled:r,type:"submit",children:r?"Registering\u2026":"Register"}),Object(f.jsx)("div",{className:"login-link-container",children:Object(f.jsx)(h.a,{className:"fullwidth",variant:"primary",onClick:function(){return t.push("/login")},children:"Log into existing account"})})]})]})};function C(e){var t=Object(u.f)(),a=Object(o.useState)(!1),n=Object(l.a)(a,2),r=n[0],s=n[1];function c(){return(c=Object(p.a)(m.a.mark((function a(n){var o,c,i,l,d,u;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n.preventDefault(),!r){a.next=3;break}return a.abrupt("return");case 3:return s(!0),o=n.target,c=o.elements.formUsername.value,i=o.elements.formPassword.value,l={email:c,password:i},console.dir(l),a.prev=9,console.log("".concat("https://companion-htv5.herokuapp.com/api/v1","/validate")),a.next=13,fetch("".concat("https://companion-htv5.herokuapp.com/api/v1","/validate"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(l)});case 13:return d=a.sent,a.next=16,d.json();case 16:u=a.sent,console.dir(u),u.data?(e.setUser(u.data),t.push("/assess")):window.alert("Invalid email or password, please try again"),a.next=25;break;case 21:a.prev=21,a.t0=a.catch(9),console.log(a.t0),window.alert("Failed to contact server :(");case 25:s(!1);case 26:case"end":return a.stop()}}),a,null,[[9,21]])})))).apply(this,arguments)}return Object(f.jsxs)("div",{className:"align-center",children:[Object(f.jsx)("h1",{children:"Log in"}),Object(f.jsxs)(b.a,{className:"width-30",onSubmit:function(e){return c.apply(this,arguments)},children:[Object(f.jsx)(y,{}),Object(f.jsx)(N,{}),Object(f.jsx)(h.a,{className:"fullwidth",variant:"primary",disabled:r,type:"submit",children:r?"Logging in\u2026":"Log in"})]})]})}a(53);var I=a(36);function T(){var e=Object(u.f)();return Object(f.jsx)(I.a,{steps:[{style:{transform:"translate(0,-500px)"},duration:0},{style:{transform:"translate(0,0)"},duration:800}],children:Object(f.jsxs)("div",{className:"align-center",children:[Object(f.jsx)("h1",{children:"Companion"}),Object(f.jsx)("h2",{children:"your mindfulness buddy"}),Object(f.jsx)(h.a,{className:"wide get-started",size:"lg",variant:"primary",onClick:function(){return e.push("/register")},children:"Get Started"})]})})}a(62);function R(e){var t=Object(u.f)(),a=Object(o.useState)(!1),n=Object(l.a)(a,2),r=n[0],s=n[1],c=Object(o.useState)(!1),i=Object(l.a)(c,2),d=i[0],j=i[1],x=Object(o.useState)(null),O=Object(l.a)(x,2),v=O[0],g=O[1],w=Object(o.useState)(""),y=Object(l.a)(w,2),N=y[0],M=y[1];function S(e){return C.apply(this,arguments)}function C(){return(C=Object(p.a)(m.a.mark((function t(a){var n,o,c;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),!r){t.next=3;break}return t.abrupt("return");case 3:return s(!0),n={mood:v,message:N},t.prev=5,t.next=8,fetch("".concat("https://companion-htv5.herokuapp.com/api/v1","/").concat(e.user._id,"/logs"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});case 8:return o=t.sent,t.next=11,o.json();case 11:c=t.sent,console.dir(c),c.error?(console.dir(c.error),window.alert("Couldn't save, please try again")):j(!0),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(5),console.dir(t.t0),window.alert("Failed to contact server :(");case 20:s(!1);case 21:case"end":return t.stop()}}),t,null,[[5,16]])})))).apply(this,arguments)}return Object(f.jsxs)("div",{className:"align-center flex-column gap-4",children:[Object(f.jsxs)("h1",{children:["Welcome back, ",e.user.firstName]}),Object(f.jsx)("h2",{children:"How are you feeling today?"}),Object(f.jsx)(U,{mood:v,setMood:g}),Object(f.jsxs)(b.a,{className:"width-50",onSubmit:S,children:[Object(f.jsx)(k,{controlId:"formMessage",label:"Describe your day\u2026",value:N,setValue:M}),Object(f.jsxs)("div",{className:"align-center flex-column",children:[Object(f.jsx)(h.a,{className:"fullwidth",variant:"success",onClick:S,disabled:!v||r||d,children:r?"Saving\u2026":d?"Entry saved":"Save"}),Object(f.jsxs)("div",{className:"fullwidth flex-row gap-2",children:[Object(f.jsx)(h.a,{className:"fullwidth",variant:"primary",onClick:function(){t.push("/diary")},children:"My diary"}),Object(f.jsx)(h.a,{className:"fullwidth",variant:"primary",onClick:function(){t.push("/companion")},children:"Talk to someone"})]})]})]})]})}function U(e){return Object(f.jsxs)("div",{className:"mood-chooser",children:[Object(f.jsx)(F,{currentMood:e.mood,setMood:e.setMood,mood:"\u263a\ufe0f"}),Object(f.jsx)(F,{currentMood:e.mood,setMood:e.setMood,mood:"\ud83d\ude04"}),Object(f.jsx)(F,{currentMood:e.mood,setMood:e.setMood,mood:"\ud83d\ude00"}),Object(f.jsx)(F,{currentMood:e.mood,setMood:e.setMood,mood:"\ud83d\ude42"}),Object(f.jsx)(F,{currentMood:e.mood,setMood:e.setMood,mood:"\ud83d\ude10"}),Object(f.jsx)("hr",{}),Object(f.jsx)(F,{currentMood:e.mood,setMood:e.setMood,mood:"\ud83d\ude15"}),Object(f.jsx)(F,{currentMood:e.mood,setMood:e.setMood,mood:"\u2639\ufe0f"}),Object(f.jsx)(F,{currentMood:e.mood,setMood:e.setMood,mood:"\ud83d\ude14"}),Object(f.jsx)(F,{currentMood:e.mood,setMood:e.setMood,mood:"\ud83d\ude25"}),Object(f.jsx)(F,{currentMood:e.mood,setMood:e.setMood,mood:"\ud83d\ude2d"})]})}function F(e){return Object(f.jsx)(h.a,{size:"sm",variant:"primary",className:"mood-button ",active:e.currentMood==e.mood,onClick:function(){return e.setMood(e.mood)},children:e.mood})}a(63);var P=function(){var e=Object(o.useState)([]),t=Object(l.a)(e,2),a=(t[0],t[1],Object(o.useState)("")),n=Object(l.a)(a,2),r=n[0],s=n[1];return Object(f.jsxs)("div",{children:[Object(f.jsx)("h1",{children:"Companion"}),Object(f.jsx)("div",{className:"messages-view-container",children:Object(f.jsx)("div",{className:"messages-view",children:Object(f.jsx)("div",{className:"message",children:Object(f.jsx)("h1",{children:"Hello"})})})}),Object(f.jsx)(b.a,{className:"message-input",children:Object(f.jsx)(b.a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:Object(f.jsx)(b.a.Control,{as:"textarea",placeholder:"Type message here",rows:3})})}),Object(f.jsx)(k,{controlId:"formMessage",label:"Type Message Here",value:r,setValue:s})]})};a(64);function J(e){Object(u.f)();var t=Object(o.useState)(!1),a=Object(l.a)(t,2),n=(a[0],a[1]),r=Object(o.useState)(null),s=Object(l.a)(r,2),c=(s[0],s[1]);return Object(o.useEffect)(Object(p.a)(m.a.mark((function t(){var a,r;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(!0),t.prev=1,t.next=4,fetch("".concat("https://companion-htv5.herokuapp.com/api/v1","/").concat(e.user._id,"/logs"),{method:"GET",headers:{"Content-Type":"application/json"}});case 4:return a=t.sent,t.next=7,a.json();case 7:r=t.sent,console.dir(r),r.error?(console.dir(r.error),window.alert("Couldn't retrieve entries, please try again")):c(r.logs),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),console.dir(t.t0),window.alert("Failed to contact server :(");case 16:n(!1);case 17:case"end":return t.stop()}}),t,null,[[1,12]])}))),[]),Object(f.jsx)("div",{className:"align-center flex-column gap-4",children:Object(f.jsx)("h1",{children:"My diary"})})}var L=function(){var e=Object(o.useState)({_id:"616b918b2749f77e074616ac",email:"demo@demo.user",firstName:"Demo",lastName:"User",password:"password",logs:[]}),t=Object(l.a)(e,2),a=t[0],n=t[1];return Object(f.jsx)("div",{className:"App flex-column",children:Object(f.jsx)(d.a,{children:Object(f.jsxs)(u.c,{children:[Object(f.jsx)(u.a,{exact:!0,path:"/",children:Object(f.jsx)(T,{})}),Object(f.jsx)(u.a,{exact:!0,path:"/login",children:Object(f.jsx)(C,{setUser:n})}),Object(f.jsx)(u.a,{exact:!0,path:"/register",children:Object(f.jsx)(S,{setUser:n})}),Object(f.jsx)(u.a,{exact:!0,path:"/assess",children:Object(f.jsx)(R,{user:a})}),Object(f.jsx)(u.a,{exact:!0,path:"/companion",children:Object(f.jsx)(P,{})}),Object(f.jsx)(u.a,{exact:!0,path:"/diary",children:Object(f.jsx)(J,{user:a})})]})})})};i.a.render(Object(f.jsx)(s.a.StrictMode,{children:Object(f.jsx)(L,{})}),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.531d3f5f.chunk.js.map